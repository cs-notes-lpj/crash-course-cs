We've already made a ALU, which takes in binary numbers and performs calculations

![20221208095212](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/by-clipboard/20221208095212.png)

and we've made two types of computer memory:

    Registers —— small, linear chunks of memory, useful for storing a single value

    and then we scaled up, and made some RAM —— a larger bank of memory that can store a lot of numbers located at different addresses.

Now it's time to put it all together and build ourselves the heart of any computer —— the CPU ( the Central Processing Unit )

### CPU 的功能

A CPU's job is to execute programs which are made up of a series of individual operations called instructions, because they "instruct" the computer what to do.

![20221208101959](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/by-clipboard/20221208101959.png)

If these are mathematical instructions, like add or subtract, the CPU will configure its ALU to do the mathematical operation.

Or it might be a memory instruction, in which case the CPU will talk with memory to read and write values.

### 那我们如何构建我们的 CPU 呢

There are lots of parts in a CPU, so we're going to lay it out piece by piece, building up as we go.

We'll focus on functional blocks, rather than showing every sigle wire. This means when we do connect two components with a line, this is an abstraction for all of the necessary wires. This high level view is called「the microarchitecture」微体系架构

### 一些准备工作

We know that data and programs can be stored in memory as binary values, thus obviously, we need some memory.

Let's drop in the RAM module we created before, and to keep things simple, we'll assume it only has 16 memory locations, each containing 8 bits.

As an example, we've initialized our RAM with a simple computer program that we'll go through today.

---

And we need 6 registers to complete our CPU which will be used to temporarily store and manipulate values.

First, we need a register to keep track of where we are in a program. For this, we use an「instruction address register」which as the name suggests, stores the memory address of the current instruction.

小声bb：这个寄存器好 tm 像指针啊 ！

And then we need another register to store the current instruction which we'll called「the instruction register」.

When we first boot up our computer, all of our registers start at `0`

![20221208111008](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/by-clipboard/20221208111008.png)

### Let's begin to build our CPU

Firstly, we can assin an ID to each instruction supported by our CPU, in our hypothetical example below, we use the first four bits to store the "operation code" or "opcode" for short and the final four bits specify where the data for that operation should come from. ( could be registers or an address in memory )

![20221208120808](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/by-clipboard/20221208120808.png)

